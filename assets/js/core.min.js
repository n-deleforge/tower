let game,refreshDisplay,refreshInterval;const _version="2.06",_github='<a href="https://github.com/n-deleforge/game-tower" target="_blank">GitHub</a>',_home='<a target="_blank" href="https://nicolas-deleforge.fr/">ND</a>',_mobile=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),_settings={data:{health:25,healthMax:25,strength:5,shield:0,xp:0,xpTo:50,level:1,floor:1,room:1,itemHeal:0,itemMagic:0,itemMineral:0,itemLimit:9,score:0,lvlUpHealth:20,lvlUpStrength:2,lvlUpShield:1,spiritHealth:10,spiritStrength:1,spiritShield:1},icons:{soundOn:'<i class="fas fa-volume-up"></i>',soundOff:'<i class="fas fa-volume-mute"></i>',vibrateOn:'<i class="fas fa-bell"></i>',vibrateOff:'<i class="fas fa-bell-slash"></i>'},images:{start:"event/firstFloor.png?2.06",monster01:"monster/monster_01.png?2.06",monster02:"monster/monster_02.png?2.06",monster03:"monster/monster_03.png?2.06",monster04:"monster/monster_04.png?2.06",monster05:"monster/monster_05.png?2.06",monster06:"monster/monster_06.png?2.06",monster07:"monster/monster_07.png?2.06",monster08:"monster/monster_08.png?2.06",monster09:"monster/monster_09.png?2.06",monster10:"monster/monster_10.png?2.06",monster11:"monster/monster_11.png?2.06",monster12:"monster/monster_12.png?2.06",monster13:"monster/monster_13.png?2.06",monster14:"monster/monster_14.png?2.06",monster15:"monster/monster_15.png?2.06",monster16:"monster/monster_16.png?2.06",monster17:"monster/monster_17.png?2.06",noEvent:"event/noEvent.png?2.06",earthSpirit:"event/spiritEarth.png?2.06",lightSpirit:"event/spiritLight.png?2.06",fireSpirit:"event/spiritFire.png?2.06",waterSpirit:"event/spiritWater.png?2.06",chest:"event/chest.png?2.06",chestOpen:"event/chestOpen.png?2.06",iconPotion:"icon/potion.png?2.06",iconMagic:"icon/magic.png?2.06",iconStrength:"icon/strength.png?2.06",iconShield:"icon/shield.png?2.06",iconMineral:"icon/mineral.png?2.06",merchant:"event/merchant.png?2.06"}},_french={main:{title:"La Tour",headerTitle:"La Tour",startTitle:"Bienvenue aventurier",nameCharacterLabel:"Quel est ton nom ?",play:"Entrer",startFooter:"Disponible sur "+_github+" (v 2.06) ©  "+_home,gameFooter:"Disponible sur "+_github+" (v 2.06) ©  "+_home,move:"Avancer",useHeal:"Utiliser une potion",openChest:"Ouvrir le coffre",closeChest:"Ne pas l'ouvrir",acceptOffer:"Accepter l'offre",refuseOffer:"Refuser l'offre",useAttack:"Attaque",useMagic:"Sortilège",settingsTitle:"Paramètres de jeu",statsTitle:"Statistiques",popupTitle:"Information importante",popupAccept:"Confirmer",popupCancel:"Annuler",popupRestart:"Voulez-vous recommencer la partie en cours ? Votre progression actuelle sera perdue.",popupDelete:"Voulez-vous effacer toutes les données de jeu ? L'application sera réinitialisée.",switchLanguage:'<i class="fas fa-sync"></i> Passer en langue anglaise'},stats:{bestScore:"Meilleur score : ",totalGame:"Nombre de partie : ",bestFloor:"Étage atteint le plus haut : ",totalRoom:"Nombre de salle parcourue : ",maxLevel:"Niveau d'expérience le plus haut : ",healUsed:"Nombre de potion utilisé : ",fightVictory:"Monstre vaincu : ",chestOpen:"Coffre ouvert : ",chestTrap:"Coffre piégé : ",chestNotOpened:"Coffre non ouvert : ",spiritMeet:"Esprit rencontré : ",merchantAccepted:"Propostion du marchant accepté : ",merchantRefused:"Proposition du marchant refusé : "},vocabulary:{health:"Santé",score:"Score",strength:"Force",shield:"Endurance",floor:"Étage",room:"Salle",level:"Niveau",point_singular:"point",point_plural:"points",hit_singular:"coup",hit_plural:"coups"},events:{nameHeroCheck:"Votre nom doit être composé de 2 à 15 lettres",levelUp_part1:"Votre niveau augmente",levelUp_part2:"Votre santé est regénérée et vos statistiques augmentent",healing:"Vous avez utilisé une potion, vous regagnez toute votre santé",noEvent:"Vous traversez tranquillement de longs couloirs",startGame_part1:"Une vieille pancarte. La plupart des mots sont effacés par le temps.",startGame_part2:'"Celui qui ... le sommet pourra ... l\'un de ses ... ! ... le danger, restez en ... et grimpez le ... haut ..."',startGame_part3:"Vous continuez votre chemin d'un pas déterminé..",spiritEarth_part1:"Un <strong>esprit de la terre</strong> vous protège",spiritEarth_part2:"Votre bouclier augmente de ",spiritLight_part1:"Un <strong>esprit de lumière</strong> se rapproche de vous",spiritLight_part2:"Vous gagnez ",spiritLight_part3:" d'expérience",spiritFire_part1:"Un <strong>esprit de feu</strong> partage son énergie",spiritFire_part2:"Votre force augmente de ",spiritWater_part1:"Un <strong>esprit d'eau</strong> partage sa vitalité",spiritWater_part2:"Votre santé augmente de ",merchant:"Un individu se dresse devant vous. Il propose un marché",merchant_noMineral:"Mais vous n'avez pas assez de <strong>pierre précieuse</strong>",merchant_proposition:"Deux <strong>pierre précieuse</strong> contre",merchant_offer1:"Votre statistique de puissance augmente beaucoup",merchant_offer2:"Votre statistique de vitalité et d'endurance augmente",merchant_offer3:"Mais rien ne se passe",merchant_accepted:"L'individu se met à rire avant de vous lancer un sort",merchant_refused:"Mais vous refusez l'offre",chest:"Vous avez trouvé un <strong>coffre</strong>",chest_notOpened:"Mais vous décidez de ne pas l'ouvrir",chestTrap_part1:"Mais c'est un <strong>piège</strong>, un poison se répand",chestTrap_part2:"Vous perdez ",chestTrap_part3:" de santé",chestMagic:"Vous trouvez un <strong>sort magique</strong>",chestHeal:"Vous trouvez une <strong>potion de soin</strong>",chestMineral:"Vous trouvez une <strong>pierre précieuse</strong>",chestLimit:"Mais vous n'avez plus assez de place",fightStart:"apparaît !",fightWin_part1:" vaincu en ",fightWin_part2:"Vous avez perdu ",fightWin_part3:" de santé",fightWin_part4:" d'expérience",fightWin_part5:"Vous avez gagné ",fightMagic:"Vous avez vaincu le monstre grâce à un sort magique",gameover_part1:"Vous avez été vaincu, la partie est terminée.<br />Vous êtes arrivé à l'étage ",gameover_part2:"Score : ",gameoverButton:"Recommencer"},monsters:{lich:"Liche des ténèbres",lightSword:"Épée de lumière",golem:"Golem de pierre",deadWarrior:"Guerrier mort-vivant",daemon:"Daémon",minotaur:"Minotaure",cerberus:"Cerbère",troll:"Troll",eyeghost:"Oeil maléfique",werewolf:"Loup-garou",monster:"Monstre marin",lizard:"Homme-lézard",gargoyle:"Gargouille",gobelin:"Gobelin",snake:"Serpent",bat:"Chauve souris",slim:"Blob"},tips:["Lorsque la santé de votre personnage tombe à 0, la partie est terminée. Cependant, un gain de niveau ou une potion restaure la totalité des points de santé.","La statistique de bouclier permet de réduire les dégâts lors d'une attaque dans un combat. Elle est uniquement augmentée par l'esprit de la terre.","Les combats se déroulent automatiquement alors veillez à bien choisir votre action de combat entre attaque et sortilège.",'Chaque monstre nécessite un nombre de coups pour être vaincu qui est calculé de la manière suivante : <em>"santé du monstre / force du héros"</em>','Les dégâts d\'un monstre sont calculés selon la formule suivante : <em>"(nombre de coups pour être vaincu * force du monstre) - le bouclier du héros"</em>',"Vaincre un monstre avec un sort rapporte peu de points d'expérience mais peut éviter une morte certaine ou de très gros dégâts.","La Tour est peuplée de divers esprits, la plupart d'entre eux vous aideront grandement lors de votre quête.","Lorsque vous ouvrez un coffre, vous avez une chance de tomber sur un monstre qui vous infligera des dégâts qui ignorent votre statistique de bouclier.","La Tour est divisé par étages. Chaque étage est lui-même composé de 10 salles. A chaque étage, les monstres deviennent plus puissants.",'Pour les plus curieux, le score de fin de partie est calculé selon la formule suivante : <em>"((bouclier + force + santé maximale) * niveau) * étage"</em>',"Chaque objet que vous pouvez récupérer est limité à une certaine quantité. Il faut faire attention à ne pas trop les utiliser et à ne pas trop les accumuler.","Un étrange marchand habite dans la Tour, il est possible qu'il vous propose une transaction contre des pierres précieuses"]},_english={main:{title:"The Tower",headerTitle:"The Tower",startTitle:"Welcome adventurer",nameCharacterLabel:"What's your name ?",play:"Enter",startFooter:"Available on "+_github+" (v 2.06) ©  "+_home,gameFooter:"Available on "+_github+" (v 2.06) ©  "+_home,move:"Move",useHeal:"Use a potion",openChest:"Open the chest",closeChest:"Do not open",useAttack:"Attack",useMagic:"Spell",settingsTitle:"Game settings",statsTitle:"Statistiques",popupTitle:"Important information",popupAccept:"Confirm",popupCancel:"Cancel",popupRestart:"Do you want to restart the current game? Your current progress will be lost. ",popupDelete:"Do you want to erase all game data? The application will be reset. ",switchLanguage:'<i class="fas fa-sync"></i> Switch to French language'},stats:{bestScore:"Best score : ",totalGame:"Number of game : ",bestFloor:"Highest floor : ",totalRoom:"Number of rooms : ",maxLevel:"Highest exp. level : ",healUsed:"Potion used : ",fightVictory:"Monsters defeated  : ",chestOpen:"Chest opened : ",chestTrap:"Trapped chest : ",chestNotOpened:"Chest not opened : ",spiritMeet:"Spirit meet : ",merchantAccepted:"Merchant deals accepted : ",merchantRefused:"Merchant deals refused : "},vocabulary:{health:"Health",score:"Score",strength:"Strength",shield:"Stamina",floor:"Floor",room:"Room",level:"Level",point_singular:"point",point_plural:"points",hit_singular:"hit",hit_plural:"hits"},events:{nameHeroCheck:"Your name must be composed between 2 to 15 letters.",levelUp_part1:"Level up",levelUp_part2:"Your health is regenerated and your stats increase",healing:"You use a potion, you regain all your health",noEvent:"You walk quietly through long corridors",startGame_part1:"An old sign. Most of the words are erased by time.",startGame_part2:'"Whoever ... the top may ... one of its ...! ... danger, stay in ... and climb the ... top ..."',startGame_part3:"You continue your journey with a determined step.",spiritEarth_part1:"A <strong>earth spirit</strong> protects you",spiritEarth_part2:"Your stamina increases by ",spiritLight_part1:"A <strong>light spirit</strong> draws near to you",spiritLight_part2:"You win ",spiritLight_part3:" of experience",spiritFire_part1:"A <strong>fire spirit</strong> shares its energy",spiritFire_part2:"Your strength increases by ",spiritWater_part1:"A <strong>water spirit</strong> shares its vitality",spiritWater_part2:"Your health increases by ",merchant:"A person stands in front of you. He proposes you a deal ",merchant_noMineral:"But you don't have enough <strong>gemstone</strong> ",merchant_proposition:"Two <strong>gemstones</strong> for",merchant_offer1:"Your strength increases a lot",merchant_offer2:"Your health and your stamina increase",merchant_offer3:"But nothing happened.",merchant_accepted:"The person laughs before casting a spell on you ",merchant_refused:"But you refuse the deal",chest:"You have found a <strong>chest</strong>",chest_notOpened:"But you decide not to open it",chestTrap_part1:"But it's a <strong>trap</strong>, a poison is spreading",chestTrap_part2:"You lost ",chestTrap_part3:" of health",chestMagic:"You find a <strong>magic spell</strong>",chestHeal:"You find a <strong>healing potion</strong>",chestMineral:"You find a <strong>precious stone</strong>",chestLimit:"But you don't have enough room",fightStart:"appears !",fightWin_part1:" defeated with ",fightWin_part2:"You have lost ",fightWin_part3:" of health",fightWin_part4:" of experience",fightWin_part5:"You have won ",fightMagic:"You have defeated the monster with a magic spell",gameover:"You have lost, the game is over.<br />Your score : ",gameover_part1:"The game is over.<br />You have been at the floor  ",gameover_part2:"Score : ",gameoverButton:"Restart"},monsters:{lich:"Darkness lich",lightSword:"Sword of light",golem:"Stone Golem",deadWarrior:"Undead warrior",daemon:"Daemon",minotaur:"Minotaur",cerberus:"Cerberus",troll:"Troll",eyeghost:"Evil eye",werewolf:"Werewolf",monster:"Sea monster",lizard:"Lizard man",gargoyle:"Gargoyle",gobelin:"Gobelin",snake:"Snake",bat:"Bat",slim:"Blob"},tips:["When the hero's health drops to 0, the game is over. However, leveling up or a potion restores all health points.","The shield stat is used to reduce damage when attacked in combat. It can only be increased by the spirit of the earth.","The fights take place automatically so be sure to choose your fight action.",'Each monster requires a number of hits to be defeated which is calculated as follows: <em>" monster health / hero strength "</em>','The damage of a monster is calculated according to the following formula: <em>" (number of hits to be defeated * strength of the monster) - hero\'s shield "</em>',"Defeating a monster with a spell doesn't grant much experience points but can prevent certain death or very large damage.","The Tower is populated by various spirits. Most of them will help you greatly on your quest.","When you open a chest, you have a chance to stumble upon a monster that will deal damage to you that ignores your shield stat.","The Tower is divided by floors. Each floor itself is made up of 10 rooms. On each floor, the monsters become more powerful.",'For the more curious, the end-of-game score is calculated according to the following formula: <em>" ((shield + strength + maximum health) * level) * floor "</em>',"At the start of the game, each item you can collect is limited to a certain quantity. Later, you can keep more.","A mysterious merchant lives in the Tower, it is possible that he offers you a transaction for gemstones"]};_mobile&&(get("#app").style.minHeight=window.innerHeight+"px"),getStorage("TOWER-save")?game=JSON.parse(getStorage("TOWER-save")):(game={core:{ongoing:!1,name:null,sound:!0,vibrate:!0,version:"2.06",language:"EN"},events:{lastAction:null,newAction:null,subAction:null,monster:null,currentEvent:null},stats:{bestScore:0,totalGame:0,bestFloor:0,totalRoom:0,maxLevel:0,healUsed:0,fightVictory:0,chestOpen:0,chestTrap:0,chestNotOpened:0,spiritMeet:0,merchantAccepted:0,merchantRefused:0},character:{health:_settings.data.health,healthMax:_settings.data.healthMax,strength:_settings.data.strength,shield:_settings.data.shield,xp:_settings.data.xp,xpTo:_settings.data.xpTo,level:_settings.data.level,floor:_settings.data.floor,room:_settings.data.room,itemHeal:_settings.data.itemHeal,itemMagic:_settings.data.itemMagic,itemMineral:_settings.data.itemMineral,score:_settings.data.score}},setStorage("TOWER-save",JSON.stringify(game)));const _content="FR"==game.core.language?_french:_english;let names=Object.keys(_content.main),values=Object.values(_content.main);for(let e=0;e<names.length;e++)get("#"+names[e])&&(get("#"+names[e]).innerHTML=values[e]);