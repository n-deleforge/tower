function launcher(){get("#start").style.display="flex",get("#displayTip").innerHTML=CONTENT.tips[rand(0,CONTENT.tips.length)],null!=_game.core.name&&""!=_game.core.name?get("#nameCharacter").value=_game.core.name:(get("#nameCharacter").value="",get("#nameCharacter").focus()),get("#play").addEventListener("click",function(){get("#nameCharacter").checkValidity()&&""!=get("#nameCharacter").value?startGame("new"):get("#nameCharacter").style.borderColor=getVariableCSS("text-error")})}function startGame(e){get("#start").style.display="none",get("#game").style.display="flex",changeDisplay("normal-game"),createMenu(),createButtons(),_refreshDisplay=setInterval(displayGame,100),"new"==e?(_game.core.name=get("#nameCharacter").value,_game.core.ongoing=!0,playSound("Room"),get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.start+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.startGame_part1+".</p>",get("#screen").innerHTML+="<em>"+CONTENT.events.startGame_part2+".</em>",get("#screen").innerHTML+="<p>"+CONTENT.events.startGame_part3+".</p>"):"load"==e&&("fight"==_game.events.lastAction&&"fightOver"!=_game.events.subAction&&changeDisplay("normal-to-fight"),"chest"==_game.events.lastAction&&"chestOver"!=_game.events.subAction&&changeDisplay("normal-to-chest"),"merchant"==_game.events.lastAction&&"merchantOver"!=_game.events.subAction&&changeDisplay("normal-to-merchant"),get("#screen").innerHTML=_game.events.currentEvent)}function playTurn(){if(_game.events.subAction=null,_game.character.room++,changeDisplay("screen-to-message"),_game.character.room>10?(_refreshInterval=2e3,_game.character.room=1,_game.character.floor++,playSound("Floor"),get("#message").innerHTML='<p class="bigger">'+CONTENT.vocabulary.floor+" "+_game.character.floor+"</p>"):(_refreshInterval=1e3,_game.stats.totalRoom++,playSound("Room"),get("#message").innerHTML='<p class="bigger">'+CONTENT.vocabulary.floor+" "+parseInt(_game.character.floor)+"</p>",get("#message").innerHTML+="<p>"+CONTENT.vocabulary.room+" "+_game.character.room+"</p>"),setTimeout(function(){changeDisplay("message-to-screen")},_refreshInterval),_game.character.floor>5&&5==_game.character.room){2==rand(1,2)?merchant():choiceAction()}else choiceAction()}function choiceAction(){let e=rand(1,4);4==e?(_game.events.newAction="spirit",_game.events.newAction!=_game.events.lastAction?spirit():choiceAction()):3==e?(_game.events.newAction="fight",_game.events.newAction!=_game.events.lastAction?fight():choiceAction()):2==e?(_game.events.newAction="chest",_game.events.newAction!=_game.events.lastAction?chest():choiceAction()):(_game.events.newAction="noEvent",_game.events.newAction!=_game.events.lastAction?noEvent():choiceAction())}function usePotion(){_game.character.itemPotion>0&&_game.character.health<_game.character.healthMax?(_game.character.itemPotion--,_game.character.health=_game.character.healthMax,_game.stats.potionUsed++,playVibrate(10),playSound("Potion"),get("#screen").innerHTML+='<hr><p class="green">'+CONTENT.events.healing+"</p>"):playVibrate(250)}function noEvent(){_game.events.lastAction="noEvent",get("#screen").innerHTML='<div id="containerImage"></div>',get("#containerImage").style.background="url('assets/image/"+SETTINGS.images.noEvent+"') no-repeat center",get("#containerImage").style.backgroundSize="cover",get("#screen").innerHTML+="<p>"+CONTENT.events.noEvent+".</p>"}function spirit(){_game.events.lastAction="spirit",_game.stats.spiritMeet++;let e=rand(1,4);if(4==e)_game.character.stamina=_game.character.stamina+SETTINGS.data.spiritStamina,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.earthSpirit+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.spiritEarth_part1+".</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.spiritEarth_part2+" <strong>"+SETTINGS.data.spiritStamina+"</strong> "+plural(SETTINGS.data.spiritStamina,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+".</p>";else if(3==e){const e=rand(parseInt(_game.character.xpTo/10),parseInt(_game.character.xpTo/5));_game.character.xp=_game.character.xp+e,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.lightSpirit+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.spiritLight_part1+".</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.spiritLight_part2+"<strong>"+e+"</strong> "+plural(e,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+CONTENT.events.spiritLight_part3+".</p>"}else 2==e?(_game.character.power=_game.character.power+SETTINGS.data.spiritPower,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.fireSpirit+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.spiritFire_part1+".</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.spiritFire_part2+" <strong>"+SETTINGS.data.spiritPower+"</strong> "+plural(SETTINGS.data.spiritPower,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+".</p>"):(_game.character.healthMax=_game.character.healthMax+SETTINGS.data.spiritHealth,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.waterSpirit+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.spiritWater_part1+".</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.spiritWater_part2+" <strong>"+SETTINGS.data.spiritHealth+"</strong> "+plural(SETTINGS.data.spiritHealth,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+".</p>")}function merchant(){_game.events.lastAction="merchant",get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.merchant+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.merchant+".</p>",_game.character.itemMineral>1?(changeDisplay("normal-to-merchant"),get("#screen").innerHTML+="<p>"+CONTENT.events.merchant_proposition+" ... </p>"):(_game.events.subAction="merchantOver",get("#screen").innerHTML+="<p>"+CONTENT.events.merchant_noMineral+" ...</p>")}function acceptMerchant(){_game.events.subAction="merchantOver",_game.stats.merchantAccepted++,playVibrate(90),playSound("Merchant"),changeDisplay("merchant-to-normal");const e=rand(1,3);3==e?(_game.character.power=_game.character.power+3,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.merchant+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.merchant_accepted+" !</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.merchant_offer1+".</p>"):2==e?(_game.character.healthMax=_game.character.healthMax+10,_game.character.stamina=_game.character.stamina+2,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.merchant+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.merchant_accepted+" !</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.merchant_offer2+".</p>"):(get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.merchant+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.merchant_accepted+" !</p>",get("#screen").innerHTML+='<p class="red">'+CONTENT.events.merchant_offer3+" ...</p>"),_game.character.itemMineral=_game.character.itemMineral-2}function refuseMerchant(){_game.events.subAction="merchantOver",_game.stats.merchantRefused++,playVibrate(10),changeDisplay("merchant-to-normal"),get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.merchant+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.merchant+" ... </p>",get("#screen").innerHTML+="<p>"+CONTENT.events.merchant_refused+" !</p>"}function chest(){_game.events.lastAction="chest",changeDisplay("normal-to-chest"),get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.chest+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.chest+" !</p>"}function openChest(){_game.events.subAction="chestOver",_game.stats.chestOpen++,playVibrate(90),playSound("Chest"),changeDisplay("chest-to-normal");const e=rand(1,15);let t=!1;if(e>10)SETTINGS.data.itemLimit>_game.character.itemPotion?_game.character.itemPotion++:t=!0,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.chestOpen+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.chestPotion+".</p>",t&&(get("#screen").innerHTML+="<p>"+CONTENT.events.chestLimit+".</p>");else if(e>5)SETTINGS.data.itemLimit>_game.character.itemScroll?_game.character.itemScroll++:t=!0,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.chestOpen+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.chestScroll+".</p>",t&&(get("#screen").innerHTML+="<p>"+CONTENT.events.chestLimit+".</p>");else if(e>1)SETTINGS.data.itemLimit>_game.character.itemMineral?_game.character.itemMineral++:t=!0,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.chestOpen+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.chestMineral+".</p>",t&&(get("#screen").innerHTML+="<p>"+CONTENT.events.chestLimit+".</p>");else{_game.stats.chestTrap++;const e=rand(1,_game.character.health/5);_game.character.health=_game.character.health-e,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.chestOpen+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.chestTrap_part1+" !</p>",get("#screen").innerHTML+='<p class="red">'+CONTENT.events.chestTrap_part2+"<strong>"+e+"</strong> "+plural(e,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+CONTENT.events.chestTrap_part3+".</p>"}}function closeChest(){_game.events.subAction="chestOver",_game.stats.chestNotOpened++,playVibrate(10),changeDisplay("chest-to-normal"),get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+SETTINGS.images.chest+'" alt=""></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.chest+" !</p>",get("#screen").innerHTML+="<p>"+CONTENT.events.chest_notOpened+".</p>"}function fight(){_game.events.lastAction="fight",_game.events.monster=bestiary(),changeDisplay("normal-to-fight"),get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+_game.events.monster[3]+'" alt="'+_game.events.monster[2]+'"></div>',get("#screen").innerHTML+="<p><strong>"+_game.events.monster[2]+"</strong> "+CONTENT.events.fightStart+" !</p>",get("#screen").innerHTML+="<p>"+CONTENT.vocabulary.health+" : <strong>"+_game.events.monster[0]+"</strong> / "+CONTENT.vocabulary.power+" : <strong>"+_game.events.monster[1]+"</strong></p>"}function bestiary(){const e=rand(2*_game.character.floor,5*_game.character.floor);let t=parseInt(rand(e/4,e/3));return(0==t||t<0)&&(t=1),e>900?[e,t,CONTENT.monsters.lich,SETTINGS.images.monster17]:e>700?[e,t,CONTENT.monsters.lightSword,SETTINGS.images.monster16]:e>500?[e,t,CONTENT.monsters.golem,SETTINGS.images.monster15]:e>400?[e,t,CONTENT.monsters.deadWarrior,SETTINGS.images.monster14]:e>350?[e,t,CONTENT.monsters.daemon,SETTINGS.images.monster13]:e>300?[e,t,CONTENT.monsters.minotaur,SETTINGS.images.monster12]:e>250?[e,t,CONTENT.monsters.cerberus,SETTINGS.images.monster11]:e>220?[e,t,CONTENT.monsters.troll,SETTINGS.images.monster10]:e>190?[e,t,CONTENT.monsters.eyeghost,SETTINGS.images.monster09]:e>160?[e,t,CONTENT.monsters.werewolf,SETTINGS.images.monster08]:e>130?[e,t,CONTENT.monsters.monster,SETTINGS.images.monster07]:e>100?[e,t,CONTENT.monsters.lizard,SETTINGS.images.monster06]:e>80?[e,t,CONTENT.monsters.gargoyle,SETTINGS.images.monster05]:e>60?[e,t,CONTENT.monsters.gobelin,SETTINGS.images.monster04]:e>40?[e,t,CONTENT.monsters.snake,SETTINGS.images.monster03]:e>20?[e,t,CONTENT.monsters.bat,SETTINGS.images.monster02]:[e,t,CONTENT.monsters.slim,SETTINGS.images.monster01]}function attack(){_game.events.subAction="fightOver",_game.stats.fightVictory++,playVibrate(10),playSound("Attack"),changeDisplay("fight-to-normal");const e=Math.ceil(_game.events.monster[0]/_game.character.power);let t=parseInt(e*_game.events.monster[1])-_game.character.stamina;1==e&&(t=0),t<0&&(t=0),_game.character.health=_game.character.health-t;const a=rand(parseInt(_game.character.xpTo/10),parseInt(_game.character.xpTo/8));_game.character.xp=_game.character.xp+a,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+_game.events.monster[3]+'" alt="'+_game.events.monster[2]+'"></div>',get("#screen").innerHTML+="<p><strong>"+_game.events.monster[2]+"</strong> "+CONTENT.events.fightWin_part1+"<strong>"+e+"</strong> "+plural(e,CONTENT.vocabulary.hit_singular,CONTENT.vocabulary.hit_plural)+" !</p>",get("#screen").innerHTML+='<p class="red">'+CONTENT.events.fightWin_part2+"<strong>"+t+"</strong> "+plural(t,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+" "+CONTENT.events.fightWin_part3+".</p>",_game.character.health>0&&(get("#screen").innerHTML+='<p class="green">'+CONTENT.events.fightWin_part5+"<strong>"+a+"</strong> "+plural(a,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+CONTENT.events.fightWin_part4+".</p>")}function useScroll(){if(_game.character.itemScroll>0){_game.events.subAction="fightOver",_game.character.itemScroll--,_game.stats.fightVictory++,playVibrate(10),playSound("Scroll"),changeDisplay("fight-to-normal");const e=parseInt(_game.character.xpTo/10);_game.character.xp=_game.character.xp+e,get("#screen").innerHTML='<div id="containerImage"><img src="assets/image/'+_game.events.monster[3]+'" alt="'+_game.events.monster[2]+'"></div>',get("#screen").innerHTML+="<p>"+CONTENT.events.fightMagic+".</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.fightWin_part5+"<strong>"+e+"</strong> "+plural(e,CONTENT.vocabulary.point_singular,CONTENT.vocabulary.point_plural)+CONTENT.events.fightWin_part4+".</p>"}else playVibrate(250)}function displayGame(){_game.character.health<1?gameOver():(checkExperience(),checkInfo(),checkItems(),checkScore(),""!=get("#screen").innerHTML&&(_game.events.currentEvent=get("#screen").innerHTML),setStorage("TOWER-save",JSON.stringify(_game)))}function gameOver(){clearInterval(_refreshDisplay),playVibrate(500),changeDisplay("screen-to-message"),get("#message").style.backgroundColor=getVariableCSS("background-gameover"),get("#message").innerHTML="<p>"+CONTENT.events.gameover_part1+_game.character.floor+".</p>",get("#message").innerHTML+='<p class="bigger">'+CONTENT.events.gameover_part2+_game.character.score+"</p>",get("#message").innerHTML+='<button class="button buttonAction" id="restart">'+CONTENT.events.gameoverButton+"</button>",get("#restart").addEventListener("click",()=>{location.reload()}),resetGame()}function changeDisplay(e){"normal-game"==e&&(get("#chestMode").style.display="none",get("#merchantMode").style.display="none",get("#fightMode").style.display="none"),"normal-to-chest"==e&&(get("#classicMode").style.display="none",get("#chestMode").style.display="flex"),"chest-to-normal"==e&&(get("#classicMode").style.display="flex",get("#chestMode").style.display="none"),"normal-to-merchant"==e&&(get("#classicMode").style.display="none",get("#merchantMode").style.display="flex"),"merchant-to-normal"==e&&(get("#classicMode").style.display="flex",get("#merchantMode").style.display="none"),"normal-to-fight"==e&&(get("#classicMode").style.display="none",get("#fightMode").style.display="flex"),"fight-to-normal"==e&&(get("#classicMode").style.display="flex",get("#fightMode").style.display="none"),"screen-to-message"==e&&(get("~header").style.display="none",get("#game").style.display="none",get("#message").style.display="flex"),"message-to-screen"==e&&(get("~header").style.display="flex",get("#game").style.display="flex",get("#message").style.display="none")}function checkInfo(){get("#headerTitle").innerHTML=CONTENT.vocabulary.floor+" "+_game.character.floor+" - "+CONTENT.vocabulary.room+" "+_game.character.room,get("#healthData").innerHTML=_game.character.health+" / "+_game.character.healthMax,get("#health").style.width=100*_game.character.health/_game.character.healthMax+"%",get("#level").innerHTML=CONTENT.vocabulary.level+" "+_game.character.level,get("#xp").style.width=100*_game.character.xp/_game.character.xpTo+"%",get("#power").innerHTML='<img src="assets/image/'+SETTINGS.images.iconPower+'" alt="">  '+_game.character.power,get("#stamina").innerHTML='<img src="assets/image/'+SETTINGS.images.iconStamina+'" alt="">  '+_game.character.stamina}function checkItems(){_game.character.itemPotion>0&&_game.character.health!=_game.character.healthMax?get("#usePotion").classList.remove("disabled"):get("#usePotion").classList.add("disabled"),_game.character.itemScroll>0?get("#useScroll").classList.remove("disabled"):get("#useScroll").classList.add("disabled"),get("#potion").innerHTML='<img src="assets/image/'+SETTINGS.images.iconPotion+'" alt=""> '+_game.character.itemPotion,get("#scroll").innerHTML='<img src="assets/image/'+SETTINGS.images.iconScroll+'" alt=""> '+_game.character.itemScroll,get("#mineral").innerHTML='<img src="assets/image/'+SETTINGS.images.iconMineral+'" alt="">  '+_game.character.itemMineral}function checkExperience(){_game.character.xp>=_game.character.xpTo&&(_game.character.level++,_game.character.power=_game.character.power+SETTINGS.data.lvlUpPower,_game.character.stamina=_game.character.stamina+SETTINGS.data.lvlUpStamina,_game.character.healthMax=_game.character.healthMax+SETTINGS.data.lvlUpHealth,_game.character.health=_game.character.healthMax,_game.character.xp=0,_game.character.xpTo=parseInt(1.25*_game.character.xpTo),get("#screen").innerHTML+='<hr><p class="green"><strong>'+CONTENT.events.levelUp_part1+"</strong> !</p>",get("#screen").innerHTML+='<p class="green">'+CONTENT.events.levelUp_part2+".</p>")}function checkScore(){_game.character.score=(_game.character.power+_game.character.stamina+_game.character.healthMax)*_game.character.level*_game.character.floor-30,_game.character.score>_game.stats.bestScore&&(_game.stats.bestScore=_game.character.score),_game.character.floor>_game.stats.bestFloor&&(_game.stats.bestFloor=_game.character.floor),_game.character.level>_game.stats.maxLevel&&(_game.stats.maxLevel=_game.character.level)}function checkSound(){_game.core.sound?(_game.core.sound=!1,get("#volumeButton").innerHTML=SETTINGS.icons.soundOff,get("#volumeButton").style.opacity=.5):(_game.core.sound=!0,get("#volumeButton").innerHTML=SETTINGS.icons.soundOn,get("#volumeButton").style.opacity=1)}function checkVibrate(){_game.core.vibrate?(_game.core.vibrate=!1,get("#vibrateButton").innerHTML=SETTINGS.icons.vibrateOff,get("#vibrateButton").style.opacity=.5):(_game.core.vibrate=!0,get("#vibrateButton").innerHTML=SETTINGS.icons.vibrateOn,get("#vibrateButton").style.opacity=1)}function checkStats(){let e=Object.values(CONTENT.stats),t=Object.values(_game.stats);for(let a=0;a<e.length;a++)0==a?get("#listStats").innerHTML="<li>"+e[a]+t[a]+"</li>":get("#listStats").innerHTML+="<li>"+e[a]+t[a]+"</li>"}function checkVersion(){_game.core.version!=VERSION&&(get("#blankPopup").style.display="block",get("#popup").style.display="flex",get("#popupText").innerHTML=CONTENT.main.updated,get("#popupCancel").style.display="none",get("#popupAccept").style.width="100%",get("#popupAccept").style.borderRadius="0 0 10px 10px",get("#popupAccept").addEventListener("click",()=>{clearInterval(_refreshDisplay),remStorage("TOWER-save"),location.reload()})),setStorage("TOWER-save",JSON.stringify(_game))}function createMenu(){get("#openMenu").addEventListener("click",()=>{""==get("#menu").style.display||"none"==get("#menu").style.display?(get("#blankMenu").style.display="block",get("#menu").style.display="flex",get("#openMenu").style.zIndex="50",get("#openMenuImg").src=SETTINGS.images.menuOpened,checkStats()):(get("#blankMenu").style.display="none",get("#menu").style.display="none",get("#openMenu").style.zIndex="5",get("#openMenuImg").src=SETTINGS.images.menuClosed)}),get("#confirmRestart").addEventListener("click",()=>{get("#blankPopup").style.display="block",get("#popup").style.display="flex",get("#popupText").innerHTML=CONTENT.main.popupRestart,get("#popupCancel").addEventListener("click",()=>{get("#blankPopup").style.display="none",get("#popup").style.display="none"}),get("#popupAccept").addEventListener("click",()=>{clearInterval(_refreshDisplay),_game.core.ongoing=!1,resetGame(),location.reload()})}),get("#confirmDelete").addEventListener("click",()=>{get("#blankPopup").style.display="block",get("#popup").style.display="flex",get("#popupText").innerHTML=CONTENT.main.popupDelete,get("#popupCancel").addEventListener("click",()=>{get("#blankPopup").style.display="none",get("#popup").style.display="none"}),get("#popupAccept").addEventListener("click",()=>{clearInterval(_refreshDisplay),remStorage("TOWER-save"),location.reload()})})}function createButtons(){get("#openMenu").style.display="block",get("#openMenu").style.visibility="visible",get("#openMenuImg").src=SETTINGS.images.menuClosed,get("#volumeButton").addEventListener("click",checkSound),get("#vibrateButton").addEventListener("click",checkVibrate),_game.core.sound?get("#volumeButton").innerHTML=SETTINGS.icons.soundOn:(get("#volumeButton").innerHTML=SETTINGS.icons.soundOff,get("#volumeButton").style.opacity=.5),_game.core.vibrate?get("#vibrateButton").innerHTML=SETTINGS.icons.vibrateOn:(get("#vibrateButton").innerHTML=SETTINGS.icons.vibrateOff,get("#vibrateButton").style.opacity=.5),get("#attack").addEventListener("click",attack),get("#useScroll").addEventListener("click",useScroll),get("#usePotion").addEventListener("click",usePotion),get("#openChest").addEventListener("click",openChest),get("#closeChest").addEventListener("click",closeChest),get("#acceptOffer").addEventListener("click",acceptMerchant),get("#refuseOffer").addEventListener("click",refuseMerchant),get("#move").addEventListener("click",()=>{playVibrate(50),playTurn()})}function playSound(e){1==_game.core.sound&&get("#sound"+e).play()}function playVibrate(e){1==_game.core.vibrate&&navigator.vibrate(e)}function resetGame(){_game.core.ongoing=!1,_game.stats.totalGame++,_game.character.health=SETTINGS.data.health,_game.character.healthMax=SETTINGS.data.healthMax,_game.character.power=SETTINGS.data.power,_game.character.stamina=SETTINGS.data.stamina,_game.character.xp=SETTINGS.data.xp,_game.character.xpTo=SETTINGS.data.xpTo,_game.character.itemPotion=SETTINGS.data.itemPotion,_game.character.itemScroll=SETTINGS.data.itemScroll,_game.character.itemMineral=SETTINGS.data.itemMineral,_game.character.level=SETTINGS.data.level,_game.character.floor=SETTINGS.data.floor,_game.character.room=SETTINGS.data.room,setStorage("TOWER-save",JSON.stringify(_game))}checkVersion(),0==_game.core.ongoing?launcher():startGame("load");